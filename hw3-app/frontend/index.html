<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>The New York Times</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}"> 
</head>
<body>
    <hr>
    <header class="header">
        <div class="logo">
            <h1>The New York Times</h1>
        </div>
        <div id="datetime">
            {{ now.strftime('%B %d, %Y %I:%M:%S %p') }}
        </div>  

        <div class="auth-container">
            {% if user %}
                <span>Welcome, {{ user.name or user.email }}</span>
                {% if user.is_moderator %}
                    <span class="moderator-badge">Moderator</span>
                {% endif %}
                <a href="{{ url_for('logout') }}" class="auth-button">Logout</a>
            {% else %}
                <a href="{{ url_for('login') }}" class="auth-button">Login</a>
            {% endif %}
        </div>
        
        <nav class="nav">
            <ul>
                <li><a href="{{ url_for('home') }}">Home</a></li>
                <li><a href="#">World</a></li>
                <li><a href="#">Politics</a></li>
                <li><a href="#">Business</a></li>
                <li><a href="#">Technology</a></li>
                <li><a href="#">Science</a></li>
                <li><a href="#">Culture</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="hyun">
            <img src="{{ url_for('static', filename='TheNewYorkTimesIMG-1.png') }}" alt="TheNewYorkTimesByHyunhoSong">
            <div class="hyun-text">
                <h2>Breaking News Headline Goes Here</h2>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio. Praesent libero. Sed cursus ante dapibus diam.</p>
            </div>
        </section>

        <div id="nyt-news">
            <h2>Real-Time Updates: News from Davis/Sacramento Area</h2>
            
            {% if error_message %}
                <div class="error-message">
                    <p>Failed to load news. Please try again later.</p>
                    <small>{{ error_message }}</small>
                </div>
            {% else %}
                <ul id="news-list">
                    {% for article in articles %}
                        <li class="article-item">
                            <div class="article-content">
                                {% if article.multimedia and article.multimedia|length > 0 %}
                                    {% set multimedia = None %}
                                    {% for media in article.multimedia %}
                                        {% if media.type == 'image' %}
                                            {% set multimedia = media %}
                                        {% endif %}
                                    {% endfor %}
                                    
                                    {% if multimedia %}
                                        <img src="https://www.nytimes.com/{{ multimedia.url }}" alt="{{ article.headline.main }}" class="article-image">
                                    {% endif %}
                                {% endif %}
                                
                                <div class="article-text">
                                    <h3><a href="{{ article.web_url }}" target="_blank">{{ article.headline.main }}</a></h3>
                                    <p>{{ article.snippet }}</p>
                                    <small>Published: {{ article.pub_date|datetimeformat }}</small>
                                </div>
                            </div>
                            
                            <div class="article-actions">
                                <a href="{{ url_for('article_details', article_id=article._id) }}" class="comment-button">View Comments</a>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
                
                {% if articles|length > 0 and has_more %}
                    <div class="load-more-container">
                        <a href="{{ url_for('home', page=(current_page|int + 1)) }}" class="load-more-button">Load More</a>
                    </div>
                {% endif %}
            {% endif %}
        </div>

        {% if user and user.is_moderator %}
            <div class="moderator-panel">
                <h2>Moderator Actions</h2>
                <a href="{{ url_for('admin_users') }}" class="admin-button">Manage Users</a>
            </div>
        {% endif %}

        <section class="news-grid">
            <article class="card">
                <img src="https://via.placeholder.com/400x250" alt="Article Image">
                <h3>Article Title 1</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio.</p>
            </article>
            <article class="card">
                <img src="https://via.placeholder.com/400x250" alt="Article Image">
                <h3>Article Title 2</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio.</p>
            </article>
            <article class="card">
                <img src="https://via.placeholder.com/400x250" alt="Article Image">
                <h3>Article Title 3</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio.</p>
            </article>
            <article class="card">
                <img src="https://via.placeholder.com/400x250" alt="Article Image">
                <h3>Article Title 4</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio.</p>
            </article>
            <article class="card">
                <img src="https://via.placeholder.com/400x250" alt="Article Image">
                <h3>Article Title 5</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio.</p>
            </article>
            <article class="card">
                <img src="https://via.placeholder.com/400x250" alt="Article Image">
                <h3>Article Title 6</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer nec odio.</p>
            </article>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 ECS 162 - Web Programming SID: 922749148 Name: Hyunho Song - All rights reserved.</p>
    </footer>
</body>
</html>